#!groovy
pipeline{
    agent any
	options{
		timeout(time: 3, unit: 'MINUTES')
		timestamps()
	}
    stages{
        stage('firstStage'){
            steps{
                echo 'Hello, it\'s a first stage'
                script{
					sh '../test'
                    def str = sh (script: 'ls', returnStdout: true ).trim()
                    def files = str.split("\\s+")
                    echo "Founded ${files.size()} files"
                    files.each{
                        echo "$it"
                        def text = sh(script: "cat $it", returnStdout: true).trim()
                        if (text == "Its test file for first test jenkins job.") echo 'done'
                    }
                }
                sh 'cat *.txt'
            }
        }
    }
    
}
